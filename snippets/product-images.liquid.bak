{% assign featured_image = product.selected_or_first_available_variant.featured_image | default: product.featured_image %}
  {% capture list %}
    {% for image in product.images %}
      {% comment %}Loop through images only once{% endcomment %}
      {{ image.id }}`~`{{ image.alt }}`~`{{ image | product_img_url: '100x' }}`~`{{ image | product_img_url: '200x' }}`~`{{ image | product_img_url: '400x' }}`~`{{ image | product_img_url: '600x' }}`~`{{ image | product_img_url: '800x' }}`~`{{ image | product_img_url: '1200x' }}`~`{{ image | product_img_url: '2000x' }}`~`{{-image.width-}}px`~`{{-image.height-}}px{% if forloop.last == false %}^{% endif %}
    {% endfor %}
  {% endcapture %}
  {% assign image_list = list | split: "^" %}
<!-- product name in mobile version -->

<div class="gallery-wrap js-product-page-gallery clearfix
            gallery-arrows--{{section.settings.gallery_arrows}}
            {% if section.settings.product_thumbs %} {{ section.settings.thumbnail_position }} {% endif %}
            slideshow_animation--{{ section.settings.slideshow_animation }}
            ">
  {% if product.metafields.c_f.product_label %}
  {% assign pro_lbls = product.metafields.c_f.product_label | split:','%}
    {% for pl in pro_lbls%}  
      {% if pl == 'New' %}<div class="new-badge thumbnail_banner"></div>{%endif%}
  	  {% if pl == 'Sold Out' or pl == 'sold-out' %}<div class="soldout-badge thumbnail_banner"></div>{%endif%}
    {%endfor%}  
  {% endif %}
  <div class="product_gallery product-{{ product.id }}-gallery
              {% if product.images.size > 1 %} multi-image {% endif %}
              {% if product.images.size <= 1 %} single-image {% endif %}
              {% if settings.slideshow_button_style != true %}light-button{% endif %}
              "
      data-zoom="{{ section.settings.activate_zoom }}"
      data-autoplay="{{ section.settings.activate_autoplay }}">
    

      {% for image_item in image_list %}
        {% assign image = image_item | split: "`~`" %}
        {% capture image_id %}{{ image[0] | strip }}{% endcapture %}
        {% capture image_alt %}{{ image[1] | strip }}{% endcapture %}
        {% capture image_100x %}{{ image[2] }}{% endcapture %}
        {% capture image_200x %}{{ image[3] }}{% endcapture %}
        {% capture image_400x %}{{ image[4] }}{% endcapture %}
        {% capture image_600x %}{{ image[5] }}{% endcapture %}
        {% capture image_800x %}{{ image[6] }}{% endcapture %}
        {% capture image_1200x %}{{ image[7] }}{% endcapture %}
        {% capture image_2000x %}{{ image[8] }}{% endcapture %}
        {% capture original_image_width %}{{- image[9] -}}{% endcapture %}
        {% capture original_image_height %}{{- image[10] -}}{% endcapture %}
        <div class="gallery-cell" data-thumb="{{ image_large }}" data-title="{% if image_alt contains 'youtube' or image_alt contains 'vimeo' %}{{ product.title }}{% else %}{{ image_alt | escape }}{% endif %}" data-image-height="{{image_600x | strip }}" data-image-width="{{ image_600x | strip }}">
          {% if image_alt contains 'youtube' or image_alt contains 'vimeo' %}
            {% assign src = image_alt | split: 'src="' %}
            {% assign src = src[1] | split: '"' | first %}

            {% if src contains '?' %}
              {% assign src = src | append: '&amp;autoplay=1&amp;rel=0' %}
            {% else %}
              {% assign src = src | append: '?autoplay=1&amp;rel=0' %}
            {% endif %}

            <div>
              <a href="{{ src }}" title="{{ product.title | escape }}">
                {{ image_alt }}
              </a>
            </div>
          {% else %}
            {% if template != 'index' and section.settings.enable_product_lightbox %}
              <a href="{{ image_600x }}" class="lightbox" rel="gallery" data-fancybox-group="gallery" data-lightbox-zoom="{{ section.settings.activate_zoom }}" >
            {% endif %}
            {% if image_width == 'full' %}
              <div class="image__container" style="max-width: {{image_600x}}">
                <img  src="{{ image_600x }}"
                      alt="{{ image_alt | escape }}"
                      class=" lazyload {{ settings.image_loading_style }}"
                      data-index="{{ forloop.index0 }}"
                      data-image-id="{{ image_id }}" itemprop="image"
                       />
              </div>
                
            {% else %}
<!--               <div class="image__container" style="max-width: {{original_image_width}};"> -->
                <div class="image__container" style="max-width: {{'600px'}};">
                <img  src="{{ image_100x }}"
                      alt="{{ image_alt | escape }}"
                      class=" lazyload {{ settings.image_loading_style }}"
                      data-index="{{ forloop.index0 }}"
                      data-image-id="{{ image_id }}"
                      data-sizes="auto" itemprop="image"
                      data-src="{{ image_600x }}"
                      srcset=" {{ image_200x }} 200w,
                                    {{ image_400x }} 400w,
                                    {{ image_600x }} 600w,
                                    {{ image_800x }} 800w,
                                    {{ image_1200x }} 1200w,
                                    {{ image_2000x }} 2000w"
                       />
              </div>
            {% endif %}
            {% if template != 'index' and section.settings.enable_product_lightbox %}
              </a>
            {% endif %}
          {% endif %}
        </div>
      {% endfor %}
    
    
  </div> 
  {% if section.settings.product_thumbs %}
    {% if product.images.size > 1 and image_width != 'full' %}
      <div class="product_gallery_nav product-{{ product.id }}-gallery-nav sliderLocation">

          {% for image_item in image_list %}
            {% assign image = image_item | split: "`~`" %}
            {% capture image_id %}{{ image[0] | strip }}{% endcapture %}
            {% capture image_alt %}{{ image[1] | strip }}{% endcapture %}
            {% capture image_100x %}{{ image[2] }}{% endcapture %}
            {% capture image_200x %}{{ image[3] }}{% endcapture %}
            {% capture image_400x %}{{ image[4] }}{% endcapture %}
            {% capture image_600x %}{{ image[5] }}{% endcapture %}
            {% capture image_800x %}{{ image[6] }}{% endcapture %}
            {% capture image_1200x %}{{ image[7] }}{% endcapture %}
            {% capture image_2000x %}{{ image[8] }}{% endcapture %}
            <div class="gallery-cell" data-title="{{ image_alt | escape }}">
                <img  src="{{ image_600x }}"
                      alt="{{ image_alt | escape }}"
                      data-index="{{ forloop.index0 }}"
                      data-image-id="{{ image_id }}"
                      data-featured-image="{{featured_image.id}}"
                      style="width:100px;height:auto;"/>
            </div>
          {% endfor %}
      </div>
    {% endif %}
  {% endif %}
     
</div>

<!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/bxslider/4.2.5/jquery.bxslider.min.css" rel="stylesheet" /> -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://npmcdn.com/flickity@2.0.10/dist/flickity.pkgd.js"></script>
<script src="{{ 'jquery.bxslider.min.js' | asset_url }}"></script>


  {% if section.settings.thumbnail_position == 'bottom-thumbnails' %}
<style>
  .gallery-cell{}
  @media screen and (min-width:320px) and (max-width:768px){
      .product_gallery_nav .gallery-cell img{margin:0 auto;}
  .bx-wrapper .bx-prev {
    left: 5px !important;}
  .bx-wrapper .bx-next{right: -15px !important} 
  }
 
</style>
<script>  
//   $('.sliderLocation').bxSlider({
//     slideWidth: 100,
//     minSlides: 4,
//     maxSlides: 4,
//     infiniteLoop: false,
//     moveSlides: 1,
//     slideMargin: 20,
//     pager: false,  
//     prevText: "",
//     nextText: "",
//     setGallerySize: false,
//     hideControlOnEnd: true
//   });
</script>
<style>
  /* DIRECTION CONTROLS (NEXT / PREV) */
  .bx-wrapper{margin:0 auto;}
  .bx-wrapper .bx-prev {left: -30px ;background: url({{ 'controls2.png' | asset_url}}) no-repeat 0 -32px;}
  .bx-wrapper .bx-next {right: -30px ;background: url({{ 'controls2.png' | asset_url}}) no-repeat -43px -32px;left:auto !important;
  }
  
  .bx-wrapper .bx-controls-direction a {
    position: absolute;
    top: 50%;
    margin-top: -16px;
    outline: 0;
    width: 32px;
    height: 32px;
    text-indent: -9999px;
    z-index: 9999;
  }
  
  @media screen and (min-width:375px) and (max-width:768px){
    .bx-wrapper .bx-prev {left: 10px !important;}
    .bx-wrapper .bx-next {right: -10px !important;left:auto !important;}
    .gallery-cell img {margin:0 auto;}
  }
  
</style>
{%elsif section.settings.thumbnail_position =='right-thumbnails'%}
<style>
   .stamp.tooltip {
    position: absolute;
    
      right: 20%;}
  .bx-wrapper{float:right !important;left:-25px;}.bx-wrapper .bx-prev {top: -15px;}.bx-wrapper .bx-prev,.bx-wrapper .bx-next{margin-left: -16px;}
  @media screen and (max-width:768px){
    .gallery-wrap.right-thumbnails .product_gallery_nav .gallery-cell{margin-left:15px;}
   
    .bx-wrapper .bx-next {
      left: 60%;}
    .bx-wrapper .bx-prev {
      left: 60%;}
    .stamp.tooltip {
      position: absolute;
      top: 25%;
      left: 4%;
      width: 35px;
      z-index: 2;
    }
   
  }
</style>
{%endif%}
{% if section.settings.thumbnail_position == 'left-thumbnails' or section.settings.thumbnail_position =='right-thumbnails'%}
<style>

  @media screen and (min-width:375px) and (max-width:768px){
  .soldout-badge 
    {
    left: 60% !important;
    }
  }
</style>
<script>
//   $('.sliderLocation').bxSlider({  
//     slideWidth:70,
//     mode: 'vertical',
//     minSlides: 4,
//     slideMargin: 6,
//     infiniteLoop: false,
//     pager: false,
//     prevText: "",
//     nextText: "",
//     hideControlOnEnd: true
//   });
</script>

{% endif %}
{% if section.settings.thumbnail_position == 'left-thumbnails' %}
<style>
  .soldout-badge,.new-badge {
    left: 100px;
  } 
   @media screen and (min-width:375px) and (max-width:768px){
  .soldout-badge,.new-badge 
    {
    left: 90% !important;
    }
   }
</style>
{%endif%}

