{% if sidebar %}
  <div class=" mobile-product-per-row-{{ settings.mobile_products_per_row }} {% if products_per_row == 2 %}six columns {% cycle collection_group_thumb: 'alpha', 'omega' %}{% elsif products_per_row == 3 %}four columns {% cycle collection_group_thumb: 'alpha', '', 'omega' %}{% else %}three columns {% cycle collection_group_thumb: 'alpha', '', '', 'omega' %}{% endif %} thumbnail {% cycle collection_group_mobile: 'even', 'odd' %}" itemprop="itemListElement" itemscope itemtype="http://schema.org/Product">
{% else %}
  <div class="mobile-product-per-row-{{ settings.mobile_products_per_row }} {% if products_per_row == 2 %}eight columns {% cycle collection_group_thumb: 'alpha', 'omega' %}{% elsif products_per_row == 3 %}one-third column {% cycle collection_group_thumb: 'alpha', '', 'omega' %}{% else %}four columns {% cycle collection_group_thumb: 'alpha', '', '', 'omega' %}{% endif %} thumbnail {% cycle collection_group_mobile: 'even', 'odd' %}" itemprop="itemListElement" itemscope itemtype="http://schema.org/Product">
{% endif %}

  {% assign collection_handles = product.collections | map: 'handle' %}
  {% if product.featured_image.alt contains 'youtube' or image.alt contains 'vimeo' %}
    {% assign alt_text = product.title %}
  {% else %}
    {% assign alt_text = product.featured_image.alt %}
  {% endif %}

  {% if settings.align_height %}
    {% assign collection_height = settings.collection_height | plus: 0 %}
    {% assign product_aspect_ratio = product.featured_image.aspect_ratio | plus: 0 %}
    {% assign product_set_width = product_aspect_ratio | times: collection_height %}

    {% if product.featured_image.width >= product.featured_image.height %}
      {% assign align_height_value = 'width: 100%; height: auto;' %}
    {% else %}
      {% assign align_height_value = 'width: 100%;' %}
    {% endif %}

  {% endif %}

  {% if products_per_row == 2 %}
    {% assign image_size =  '600px' %}
  {% elsif products_per_row == 3 %}
    {% assign image_size =  '400px' %}
  {% else %}
    {% assign image_size =  '300px' %}
  {% endif %}

  {% if settings.mobile_products_per_row == "2" %}
    {% assign mobile_image_size =  '150px' %}
  {% else %}
    {% assign mobile_image_size =  '300px' %}
  {% endif %}
{% assign color_img = '' %} {%assign color_repeat=false%}
    {% for product_option in product.options_with_values %}
    {% assign optname = product_option.name | downcase | strip %}
    	{% if optname contains "qty" %}     
   		 {%for variant in product.variants %}    
   		  {%if variant.option1 == value and  color_repeat == false%}
    	   {% assign color_img = variant.image.src | default :product.featured_image  %}
    		{% assign color_repeat = true %}
            <div class="product-wrap">
              <a href="{{ variant.url }}" itemprop="url" title="{{value}}" class="product-info__caption ">
                <div class="relative product_image">
                  <div class="product_container swap-{{ settings.collection_secondary_image }}">
                    <div class="image__container" style="{% if settings.align_height %} max-width: {{ product_set_width }}px; {% else %} max-width: {{- product.featured_image.width -}}px; {% endif %}">
                      {% comment %}
                      {% include 'rollover-images' %}
                      {% endcomment %}
                      <img  src="{{ color_img | product_img_url: '400x' }}"
                           alt="{{ alt_text | escape }}"
                           class="lazyloaded"
                           srcset="{{ color_img | product_img_url: '300x' }} 300w,
                                   {{ color_img | product_img_url: '400x' }} 400w,
                                   {{ color_img | product_img_url: '500x' }}"
                           />
                      {% if settings.collection_secondary_image != blank %}
                      <div class="image__container" style="max-width: {% if product.images[1] != blank %}{{- product.images[2].width -}}px{% else %}{{- product.featured_image.width -}}px{% endif %}; ">
                        <img src="{% if product.images[1] != blank %}{{ product.images[1] | product_img_url: '400x' }}{% else %}{{ product.featured_image | product_img_url: '400x' }}{% endif %}"
                             class="secondary"
                             alt="{{ alt_text | escape }}"
                             />
                      </div>
                      {% endif %}
                    </div>

                  </div>
                </div>

                <div class="info product-details">
                  {% assign title_color = product.metafields.c_f.product_title_color | default : "000" %}
                  <span class="title" itemprop="name" style="color:#{{title_color}};">{{ product.title }} {% if variant %}- {{ variant.title }} {% endif %}</span>
                  {% if settings.display_vendor_collection %}
                  <div class="vendor">
                    <span itemprop="brand">{{ product.vendor }}</span>
                  </div>
                  {% endif %}

                  {% if settings.enable_shopify_collection_badges %}
                  <span class="shopify-product-reviews-badge" data-id="{{ product.id }}"></span>
                  {% endif %}

                  {% unless collection_handles contains 'coming-soon' %}
                  <span class="price {% if variant.compare_at_price > variant.price %}sale{% endif %}">
                    {% if product.available %}
                    {% if product.price_varies and product.price_min > 0 %}
                    <!--           <small><em>{{ 'products.general.from' | t }}</em></small> -->
                    {% endif %}
                    {% if variant.price > 0 %}
                    <span class="money">{{ variant.price | money }}</span>
                    {% else %}
                    {{ settings.free_price_text }}
                    {% endif %}
                    {% else %}
                    <span class="sold_out">{{ 'products.product.sold_out' | t }}</span>
                    {% endif %}
                    {% if variant.compare_at_price > variant.price %}
                    <span class="was_price">
                      <span class="money">{{ variant.compare_at_price | money }}</span>
                    </span>
                    {% endif %}
                  </span>
                  {% endunless %}
                </div>


      </a>
      {% if settings.quick_shop_enabled %}
      {% include 'quick-shop-button', prod_var: variant %}
      {% endif %}
      {% if  product.metafields.c_f.mini_product_details != blank %}
      <p class="c_f_mini_product_details">{{product.metafields.c_f.mini_product_details  }}</p>
      {% endif %}
    </div>
    		{% endif %}
    	   {% endfor %}
          {% endif %}
         {% endfor %}
    {% comment %} {% include 'collection-swatch' %} {% endcomment %}
    </div>

