{% if sidebar %}
<div class="mobile-product-per-row-{{ settings.mobile_products_per_row }} {% if products_per_row == 2 %}six columns {% cycle collection_group_thumb: 'alpha', 'omega' %}{% elsif products_per_row == 3 %}four columns {% cycle collection_group_thumb: 'alpha', '', 'omega' %}{% elsif products_per_row == 4 %}three columns {% cycle collection_group_thumb: 'alpha', '', '', 'omega' %}{% else %}one-fifth-sidebar column {% cycle collection_group_thumb: 'alpha', '', '', '', 'omega' %}{% endif %} thumbnail {% cycle collection_group_mobile: 'even', 'odd' %}">
  {% else %}
  <div class="mobile-product-per-row-{{ settings.mobile_products_per_row }} 
              {% if template != "collection.minipop" %}              
              {% if products_per_row == 2 %}
              eight columns {% cycle collection_group_thumb: 'alpha', 'omega' %}
              {% elsif products_per_row == 3 %}
              one-third column {% cycle collection_group_thumb: 'alpha', '', 'omega' %}
              {% elsif products_per_row == 4 %}
              four columns {% cycle collection_group_thumb: 'alpha', '', '', 'omega' %}
              {% elsif products_per_row == 5 %}
              one-fifth column {% cycle collection_group_thumb: 'alpha', '', '', '', 'omega' %}
              {% elsif products_per_row == 6 %}
              one-sixth column {% cycle collection_group_thumb: 'alpha', '', '', '', '', 'omega' %}
              {% else %}
              one-seventh column {% cycle collection_group_thumb: 'alpha', '', '', '', '', '', 'omega' %}
              {% endif %} 
              {% else %} four columns {% cycle collection_group_thumb: 'alpha', '', '', 'omega' %}
              {% endif %} thumbnail {% cycle collection_group_mobile: 'even', 'odd' %}">
    {% endif %}

    {% assign collection_handles = product.collections | map: 'handle' %}
    {% if product.featured_image.alt contains 'youtube' or image.alt contains 'vimeo' %}
    {% assign alt_text = product.title %}
    {% else %}
    {% assign alt_text = product.featured_image.alt %}
    {% endif %}

    {% if settings.align_height %}
    {% assign collection_height = settings.collection_height | plus: 0 %}
    {% assign product_aspect_ratio = product.featured_image.aspect_ratio | plus: 0 %}
    {% assign product_set_width = product_aspect_ratio | times: collection_height %}

    {% if product.featured_image.width >= product.featured_image.height %}
    {% assign align_height_value = 'width: 100%; height: auto;' %}
    {% else %}
    {% assign align_height_value = 'width: 100%;' %}
    {% endif %}

    {% endif %}
    <div class="product-wrap">
      <div class="relative product_image swap-{{ settings.collection_secondary_image }}">
        <!--hiii  -->
        <a href="{{ product.url | within: collection }}" itemprop="url">
          <div class="image__container" style="{% if settings.align_height %} max-width: {{ product_set_width }}px; {% else %} max-width: {{- product.featured_image.width -}}px; {% endif %}">
            <img  src="{{ product.featured_image | product_img_url: '100x' }}"
                 alt="{{ alt_text | escape }}"
                 class="lazyload {{ settings.image_loading_style }}"
                 style="{{ align_height_value }} max-width: {{- product.featured_image.width -}}px;"
                 data-sizes="auto"
                 data-src="{{ product.featured_image | product_img_url: '400x' }}"
                 data-srcset=" {{ product.featured_image | product_img_url: '300x' }} 300w,
                              {{ product.featured_image | product_img_url: '400x' }} 400w,
                              {{ product.featured_image | product_img_url: '500x' }}"
                 />
          </div>
          {% if settings.collection_secondary_image != blank %}
          <div class="image__container" style="max-width: {% if product.images[1] != blank %}{{- product.images[1].width -}}px{% else %}{{- product.featured_image.width -}}px{% endif %}; ">
            <img src="{% if product.images[1] != blank %}{{ product.images[1] | product_img_url: '400x' }}{% else %}{{ product.featured_image | product_img_url: '400x' }}{% endif %}"
                 class="secondary lazyload"
                 alt="{{ alt_text | escape }}"/>
          </div>
          {% endif %}
        </a>
      </div>
       
      <a class="product-info__caption {% if settings.thumbnail_hover_enabled %}hidden{% endif %}" title="{{product.title | escape}}" href="{{ product.url | within: collection }}" itemprop="url">
        {% include "product-details" %}
        {% include "product-info" %}
      </a>
      
      {% if  product.metafields.c_f.mini_product_details != blank %}
      <p class="c_f_mini_product_details">{{product.metafields.c_f.mini_product_details}}</p>
      {% endif %}
    </div>
    {% include 'collection-swatch' %}
    </div>
